<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Love currency</title>

    <link rel="stylesheet" href="assets/bootstrap.min.css">
    <link rel="stylesheet" href="assets/photon.min.css">
    <link rel="stylesheet" href="assets/font-awesome.min.css">
    <link rel="stylesheet" href="assets/custom.css">
    </head>

    <body style="-webkit-app-region: drag">
      <div class="window">


      <!-- Your app's content goes inside .window-content -->
      <div class="window-content">
        <div class="pane-group">
          <div class="pane-sm sidebar">
            <nav class="nav-group">
              <h5 class="nav-group-title">sidebar</h5>
              <span class="nav-group-item active">
                <span class="icon icon-home"></span>
                Home
              </span>
              <span class="nav-group-item">
                <span class="icon icon-light-up"></span>
                Favorites
              </span>
              <span class="nav-group-item">
                <span class="icon icon-download"></span>
                Download
              </span>
            </nav>
          </div>
          <div class="pane">
            <center>
              <div class="alert alert-success" role="alert">
                <h4 class="alert-heading">Love currency!</h4>
                <p>Aww yeah, Thank you for choosing our application. If you have any questions or feedback, please email us to sankar@learnsomuch.com </p>
                </div>

              <div class="container">
                <form>
                <div class="row">
                 <div class="col-sm-6">
                   <div class="form-group">
                      <label for="exampleInputEmail1">Currency From </label>
                      <input type="text" class="form-control" id="from" aria-describedby="textHelp" placeholder="Enter country">
                      <small id="textHelp" class="form-text text-muted">Please enter the country you want to convert from. </small>
                  </div>
                 </div>
                 <div class="col-sm-6">
                   <div class="form-group">
                      <label for="exampleInputEmail1">Currency To </label>
                      <input type="text" class="form-control" id="to" aria-describedby="textHelp" placeholder="Enter country">
                      <small id="textHelp" class="form-text text-muted">Please enter the country you want to convert to .</small>
                  </div>
                 </div>
               </div>
               <div class="row">
                 <button type="button" class="btn btn-success">Convert</button>
               </div>
             </form>
              </div>

              <h2 id="currency"></h2>
              <h3 id="currencyrate"></h3>

              <h3 id="company"></h3>
              <div class="the-price" id="price"></div>
              <div class="up-down" id="priceHistory"></div>
            </center>
          </div>
        </div>
      </div>
    </div>

      <script src="assets/jquery-3.1.1.min.js"></script>
      <script src="assets/tether.min.js"></script>
      <script src="assets/jquery-2.2.4.min.js"></script>
      <script src="assets/bootstrap.min.js"></script>

      <script>
        var request = require('request');
        setInterval(function() {
          request("https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.xchange%20where%20pair%20in%20(%22EURINR%22)&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=", function(error, response, body) {
            if (!error && response.statusCode == 200) {
              body  = JSON.parse(body);
              console.log(body);
              newRate(body);
              //newPrice(body);
              //newCompany(body);
            }
          });

        }, 1800);

        var lastPrice;
        function newRate(content) {
          currentRate = content.query.results.rate.Rate;
          currencyfrom = content.query.results.rate.Name.substring(0,3);
          currencyto = content.query.results.rate.Name.substring(4,7);
          document.getElementById("currencyrate").innerHTML = "Current Rate: " + currentRate;
          document.getElementById("currency").innerHTML = "1 " + currencyfrom + " to " + currencyto;

          var history = document.getElementById("priceHistory");
          if(lastPrice<currentRate) {
            var newElText = "▲";
            var wrap = document.createElement("span");
            wrap.className = "up";
          } else if(lastPrice==currentRate) {
            var newElText = "◼︎";
            var wrap = document.createElement("span");
            wrap.className = "noChange";
          } else {
            var newElText = "▼";
            var wrap = document.createElement("span");
            wrap.className = "down";
          }
          history.appendChild(wrap);
          var textNode = document.createTextNode(newElText);
          wrap.appendChild(textNode);

          var nodeList = history.getElementsByTagName("SPAN").length;
          if(nodeList==25) {
            history.children[0].remove();
          }

          lastPrice = currentRate;
        }
      </script>
    </body>
</html>
